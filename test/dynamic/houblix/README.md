## Houblix tests

This directory contains tests based on a grammar for `hopix`, an ML-like
language that has been developed in the setting of a compilation course.

The subdirectory `src` contains the source code of `hopix`.

The subdirectory `backends` contains multiple back-ends. A back-end is a set
of Menhir settings. Each back-end is described by a subdirectory whose name
ends in `.backend`. Each such directory contains a `dune` file that specifies
the desired options. In order to reduce maintenance work, these `dune` files
are generated by `backends/Makefile` (which must be manually invoked!).

The `tests` subdirectory contains test directories, whose names end either
with `.sexp.tests` or with `.pretty.tests`. Pretty tests are tests where a
`hopix` source file is parsed and pretty-printed, and where the pretty-printed
output is compared against a reference. The `sexp` tests are analogous but use
an S-expression representation of the AST. These tests are stricter, as they
check that correct positions are recorded in the AST.

The `tests` directory also contains the script `test.ml`, which generates a
file named `dune.auto` in the `tests` directory and in each of the
subdirectories `*.tests`. Running this script via the command `ocaml test.ml`
or `dune exec ./test.exe` is sufficient. Running `make depend` in the root
directory also works. You should run this command every time you add or delete
either a test or a back-end.

You can run the tests in this directory by typing `dune build @test_houblix`.
They are also run as part of `make test` in the root directory.
